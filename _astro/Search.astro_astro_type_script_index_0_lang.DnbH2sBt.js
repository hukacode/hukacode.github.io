const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/ui-core.5vfW5kUq.js","_astro/preload-helper.BlTxHScW.js"])))=>i.map(i=>d[i]);
import{_ as n}from"./preload-helper.BlTxHScW.js";class s extends HTMLElement{openBtn;closeBtn;dialog;dialogFrame;observer;initialized=!1;idleCallbackId=null;pagefindUI=null;constructor(){super(),this.openBtn=this.querySelector("button[data-open-modal]"),this.closeBtn=this.querySelector("button[data-close-modal]"),this.dialog=this.querySelector("dialog"),this.dialogFrame=this.querySelector(".dialog-frame"),this.openBtn.addEventListener("click",this.openModal),this.openBtn.disabled=!1,this.closeBtn.addEventListener("click",this.closeModal),this.observer=new MutationObserver(this.queueDOMCheck)}connectedCallback(){if(window.addEventListener("keydown",this.onWindowKeydown),!document.querySelector("#pagefind-search"))return;(window.requestIdleCallback||(t=>setTimeout(t,1)))(async()=>{const{PagefindUI:t}=await n(async()=>{const{PagefindUI:l}=await import("./ui-core.5vfW5kUq.js");return{PagefindUI:l}},__vite__mapDeps([0,1]));this.pagefindUI=new t({element:"#pagefind-search",baseUrl:"/",bundlePath:"/".replace(/\/$/,"")+"/pagefind/",showImages:!1,showSubResults:!0,showEmptyFilters:!1,openFilters:["Tags"],translations:{placeholder:"Tip: Use âŒ˜K or ^K to open search",zero_results:"Couldn't find [SEARCH_TERM]"}}),this.observer.observe(this.dialog,{childList:!0,subtree:!0});const o=new URLSearchParams(window.location.search).get("q");o&&(this.openModal(),this.pagefindUI.triggerSearch(o))})}disconnectedCallback(){window.removeEventListener("keydown",this.onWindowKeydown),this.observer.disconnect(),this.idleCallbackId!==null&&(window.cancelIdleCallback||clearTimeout)(this.idleCallbackId)}queueDOMCheck=()=>{if(this.initialized)return;this.idleCallbackId!==null&&(window.cancelIdleCallback||clearTimeout)(this.idleCallbackId);const e=window.requestIdleCallback||(i=>setTimeout(i,0));this.idleCallbackId=e(this.checkForFilterBlocks)};checkForFilterBlocks=()=>{if(this.idleCallbackId=null,this.initialized)return;const e=this.dialog.querySelectorAll(".pagefind-ui__filter-block");e.length>=2&&(this.initializeFilterBlocks(e),this.initialized=!0,this.observer.disconnect())};initializeFilterBlocks=e=>{const i=e[1];window.innerWidth>=640?i.setAttribute("open",""):i.removeAttribute("open")};onWindowClick=e=>{("href"in(e.target||{})||document.body.contains(e.target)&&!this.dialogFrame.contains(e.target))&&this.closeModal()};onWindowKeydown=e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&!this.dialog.open&&(this.openModal(),e.preventDefault())};openModal=e=>{this.dialog.showModal(),this.querySelector("input")?.focus(),e?.stopPropagation(),window.addEventListener("click",this.onWindowClick)};closeModal=()=>{this.dialog.open&&(this.dialog.close(),window.removeEventListener("click",this.onWindowClick))}}customElements.define("site-search",s);
