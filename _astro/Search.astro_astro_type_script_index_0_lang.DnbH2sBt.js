const __vite__mapDeps=(e,i=__vite__mapDeps,t=i.f||(i.f=["_astro/ui-core.5vfW5kUq.js","_astro/preload-helper.BlTxHScW.js"]))=>e.map((e=>t[e]));import{_ as n}from"./preload-helper.BlTxHScW.js";class s extends HTMLElement{openBtn;closeBtn;dialog;dialogFrame;observer;initialized=!1;idleCallbackId=null;pagefindUI=null;constructor(){super(),this.openBtn=this.querySelector("button[data-open-modal]"),this.closeBtn=this.querySelector("button[data-close-modal]"),this.dialog=this.querySelector("dialog"),this.dialogFrame=this.querySelector(".dialog-frame"),this.openBtn.addEventListener("click",this.openModal),this.openBtn.disabled=!1,this.closeBtn.addEventListener("click",this.closeModal),this.observer=new MutationObserver(this.queueDOMCheck)}connectedCallback(){window.addEventListener("keydown",this.onWindowKeydown),document.querySelector("#pagefind-search")&&(window.requestIdleCallback||(e=>setTimeout(e,1)))((async()=>{const{PagefindUI:e}=await n((async()=>{const{PagefindUI:e}=await import("./ui-core.5vfW5kUq.js");return{PagefindUI:e}}),__vite__mapDeps([0,1]));this.pagefindUI=new e({element:"#pagefind-search",baseUrl:"/",bundlePath:"/".replace(/\/$/,"")+"/pagefind/",showImages:!1,showSubResults:!0,showEmptyFilters:!1,openFilters:["Tags"],translations:{placeholder:"Tip: Use âŒ˜K or ^K to open search",zero_results:"Couldn't find [SEARCH_TERM]"}}),this.observer.observe(this.dialog,{childList:!0,subtree:!0});const i=new URLSearchParams(window.location.search).get("q");i&&(this.openModal(),this.pagefindUI.triggerSearch(i))}))}disconnectedCallback(){window.removeEventListener("keydown",this.onWindowKeydown),this.observer.disconnect(),null!==this.idleCallbackId&&(window.cancelIdleCallback||clearTimeout)(this.idleCallbackId)}queueDOMCheck=()=>{if(this.initialized)return;null!==this.idleCallbackId&&(window.cancelIdleCallback||clearTimeout)(this.idleCallbackId);const e=window.requestIdleCallback||(e=>setTimeout(e,0));this.idleCallbackId=e(this.checkForFilterBlocks)};checkForFilterBlocks=()=>{if(this.idleCallbackId=null,this.initialized)return;const e=this.dialog.querySelectorAll(".pagefind-ui__filter-block");e.length>=2&&(this.initializeFilterBlocks(e),this.initialized=!0,this.observer.disconnect())};initializeFilterBlocks=e=>{const i=e[1];window.innerWidth>=640?i.setAttribute("open",""):i.removeAttribute("open")};onWindowClick=e=>{("href"in(e.target||{})||document.body.contains(e.target)&&!this.dialogFrame.contains(e.target))&&this.closeModal()};onWindowKeydown=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&!this.dialog.open&&(this.openModal(),e.preventDefault())};openModal=e=>{this.dialog.showModal(),this.querySelector("input")?.focus(),e?.stopPropagation(),window.addEventListener("click",this.onWindowClick)};closeModal=()=>{this.dialog.open&&(this.dialog.close(),window.removeEventListener("click",this.onWindowClick))}}customElements.define("site-search",s);